<!-- based on https://github.com/up42/up42-py/blob/master/docs/theme_override_home/home.html (MIT) -->
<!-- Custom HTML site displayed as the Home chapter -->

{% extends "main.html" %}
{% block tabs %}
{{ super() }}
<style>
    .md-footer {
        background-color: inherit !important;
    }

    .tx-container {
        padding-top: .0rem;
        overflow: hidden;
        position: relative;
        width: 100%;
        z-index: 1
    }

    .tx-container-bg {
        width: 100%;
        height: 100%;
        background-size: cover;
        -webkit-filter: blur(5px);
        -moz-filter: blur(5px);
        -o-filter: blur(5px);
        -ms-filter: blur(15px);
        filter: blur(5px);
        position: absolute;
        left:0;
        top: 0;
        background-image: url("theme/main_bg_image.jpg");
        z-index: -10;
        -webkit-box-shadow: 0 0 100px 3px #000 inset;
        -moz-box-shadow: 0 0 100px 3px #000 inset;
        box-shadow: 0 0 100px 3px #000 inset;
    }

    .tx-hero {
        margin: 32px 2.8rem;
        color: var(--md-primary-bg-color);
        justify-content: center;
    }

    .tx-hero h1 {
        margin-bottom: 1rem;
        color: currentColor;
        font-weight: 700
    }

    .tx-hero__content {
        padding-bottom: 1rem;
        margin: 0 auto;
    }

    .tx-hero__image {
        width:17rem;
        height:17rem;
        order:1;
        padding-right: 2.5rem;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }

    .tx-hero__image img {
        width:100%;
    }

    .tx-hero .md-button {
        margin-top: .5rem;
        margin-right: .5rem;
        color: var(--md-primary-bg-color)
    }

    .tx-hero .md-button--primary {
        background-color: var(--md-primary-bg-color);
        color: hsla(280deg, 37%, 48%, 1);
        border-color: var(--md-primary-bg-color)
    }

    .tx-hero .md-button:focus,
    .tx-hero .md-button:hover {
        background-color: var(--md-accent-fg-color);
        color: var(--md-default-bg-color);
        border-color: var(--md-accent-fg-color)
    }

    .feature-item h2 svg {
        height: 30px;
        float: left;
        margin-right: 10px;
        transform: translateY(10%);
        color: var(--md-primary-bg-color)
    }

    .top-hr {
        margin-top: 42px;
    }

    .feature-item {
        font-family: 'Lato', sans-serif;
        font-weight: 300;
        box-sizing: border-box;
        padding: 0 15px;
        word-break: break-word;
        background-image: url("theme/background_red.jpg");
        border: 2px solid gray;
        border-radius: 10px;
        margin-bottom: 20px;
    }

    .feature-item h2 {
        font-weight: 300;
        font-size: 25px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        line-height: normal;
        margin-top: 20px;
        margin-bottom: 10px;
        font-family: inherit;
    }

    .feature-item p {
        font-size: 16px;
        line-height: 1.8em;
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
        margin: 0 0 10px;
        display: block;
    }

    @media screen and (max-width:30em) {
        .tx-hero h1 {
            font-size: 1.4rem
        }
    }

    @media screen and (min-width:60em) {
        .md-sidebar--secondary {
            display: none
        }

        .tx-hero {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tx-hero__content {
            max-width: 25rem;
            margin-top: 3.5rem;
            margin-bottom: 3.5rem;
            margin-left: 1.0rem;
            margin-right: 4.0rem;
            align-items: center;
        }

        .tx-hero__content h1 {
            text-shadow: 2px 2px 0px #000000;
        }

        .tx-hero__content p {
            text-shadow: 2px 2px 0px #000000;
        }
    }

    @media screen and (min-width:76.25em) {
        .md-sidebar--primary {
            display: none
        }

        .top-hr {
            width: 100%;
            display: flex;
            max-width: 61rem;
            margin-right: auto;
            margin-left: auto;
            padding: 0 .2rem;
        }

        .bottom-hr {
            margin-top: 10px;
            width: 100%;
            display: flex;
            max-width: 61rem;
            margin-right: auto;
            margin-left: auto;
            padding: 0 .2rem;
        }

        .feature-item {
            background-image: url("theme/background_red.jpg");
            flex: 1;
            min-width: 0;
            margin-left: 20px;
            border: 2px solid gray;
            border-radius: 10px;
        }
    }

    .hr {
        border-bottom: 1px solid #eee;
        width: 100%;
        margin: 20px 0;
    }

    .text-center {
        text-align: center;
        padding-right: 15px;
        padding-left: 15px;
        margin-right: auto;
        margin-left: auto;
        margin-top: 15px;
        font-family: 'Lato', sans-serif;
        font-size: 23px;
        font-weight: 300;
        padding-bottom: 10px;
    }

    .logos {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-flow: row wrap;
        margin: 0 auto;
    }

    .logos img {
        flex: 1 1 auto;
        padding: 25px;
        max-height: 130px;
        vertical-align: middle;
    }

    .hr-logos {
        margin-top: 0;
        margin-bottom: 30px;
    }

    .md-footer-meta__inner {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        margin-top: 1.0rem;
    }

    .md-footer-social {
        padding-top: 20px;
    }

    .screenshot {
        box-sizing: border-box;
        width: 100%;
    }

    .screenshot-box {
        display: flex;
        align-items: center;
        padding: 0;
    }
</style>

<script>
    (function(){
        window.API_URL = "{{ config.extra.api_url | default('') }}";
        window.API_ENDPOINT_STATS = "{{ config.extra.api_endpoint_stats | default('') }}";
        // Endpoint path (relative) and element selector
        const statsPath = 'api_endpoint_stats';
        const statElementId = 'lobby_stat';

        const url = window.API_URL + window.API_ENDPOINT_STATS;

        // Fetch and write counts into #lobby_stat
        fetch(url, { method: 'GET', credentials: 'omit' })
            .then(resp => { if (!resp.ok) throw new Error('Network response not ok'); return resp.json(); })
            .then(json => {
                try {
                    const players = json && json.onlinePlayersCount && json.onlinePlayersCount.current;
                    const gamesNow = json && json.gameCount && json.gameCount.current;
                    const gamesDay = json && json.gameCount && json.gameCount.lastDay;

                    const el = document.getElementById(statElementId);
                    if (!el) return;

                    const lines = [];
                    if (typeof players === 'number' || (typeof players === 'string' && players.match(/^[0-9]+$/))) {
                        lines.push(`${players} online`);
                    }
                    if (typeof gamesNow === 'number' || (typeof gamesNow === 'string' && gamesNow.match(/^[0-9]+$/))) {
                        lines.push(`${gamesNow} games now`);
                    }
                    if (typeof gamesDay === 'number' || (typeof gamesDay === 'string' && gamesDay.match(/^[0-9]+$/))) {
                        lines.push(`${gamesDay} games in last 24h`);
                    }

                    if (lines.length) el.innerHTML = lines.map(l => `<div>${l}</div>`).join('');
                } catch (e) {
                    // silent fail
                    console.warn('Failed to parse lobby stats', e);
                }
            })
            .catch(err => {
                // keep original text on error
                console.debug('Could not fetch lobby stats:', err);
            });
    })();
</script>

<!-- Main site Entry button descriptions -->
<section class="tx-container">
    <div class="tx-container-bg"></div>
    <div class="md-grid md-typeset">
      <div class="tx-hero">
        <div class="tx-hero__image">
          <img src="assets/logo2.svg" draggable="false">
        </div>
        <div class="tx-hero__content">
          <h1> VCMI </h1>
          <p>VCMI is an open-source engine for Heroes III, offering new and extended possibilities. To use VCMI, you need to own the original data files.</p>
          <a href="download" title="Download" class="md-button md-button--primary">
            Download
          </a>
          <a href="blog" title="News" class="md-button md-button--primary">
            News
          </a>
          <a href="https://forum.vcmi.eu/" title="Forum" class="md-button md-button--primary">
            Forum
          </a>
          <br />
          <a href="https://discord.gg/chBT42V" title="Go to Discord" class="md-button">
            Go to VCMI-Discord
          </a>
        </div>
      </div>
    </div>
</section>

<!-- Main site box descriptions -->
<div class="top-hr">
    <div class="feature-item">
        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path fill="currentColor"
                    d="M18.69,3H5.31A1.31,1.31,0,0,0,4,4.31V15H20V4.31A1.31,1.31,0,0,0,18.69,3ZM18,12H6V5H18Z"/>
                <path fill="currentColor"
                    d="M21.85,19.47C21.67,19.19,20,16,20,16H4s-1.64,3.17-1.82,3.43A1,1,0,0,0,2,20a1,1,0,0,0,1,1H21a1,1,0,0,0,1-1A1.08,1.08,0,0,0,21.85,19.47ZM14.5,19h-5a.5.5,0,0,1,0-1h5a.5.5,0,0,1,0,1Z"/>
            </svg>
            GUI improvements
        </h2>
        <p>high resolutions, stack queue, creature window...</p>
    </div>
    <div class="feature-item">
        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path fill="currentColor"
                    d="M15 17v-3h3v-2l4 3.5-4 3.5v-2h-3m2 1v3h-3v2l-4-3.5 4-3.5v2h3M12 8c-2.21 0-4 1.8-4 4 0 1.91 1.35 3.54 3.21 3.92L16 11.86A3.997 3.997 0 0012 8m0 6c-1.1 0-2-.89-2-2s.9-2 2-2 2 .9 2 2-.89 2-2 2m9.66-5.27l-2-3.46c-.12-.22-.38-.31-.61-.22l-2.49 1c-.51-.41-1.06-.74-1.69-1l-.37-2.63A.506.506 0 0014 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.26-1.17.59-1.69 1L5 5.05c-.23-.09-.5 0-.61.22l-2 3.46c-.13.21-.08.49.11.64L4.57 11l-.07 1 .07 1-2.11 1.63c-.2.15-.25.43-.12.64l2 3.46c.11.27.4.38.66.27l2.5-1c.24.19.5.37.76.53l1.65-1.4c-.77-.33-1.45-.82-2-1.45l-2.41 1-.77-1.3L6.8 13.8a5.55 5.55 0 010-3.6L4.69 8.65l.75-1.3 2.41 1c.78-.9 1.83-1.53 3-1.78l.4-2.57h1.5l.37 2.62c1.17.24 2.22.88 3 1.77l2.41-1 .75 1.3-2.08 1.51c.09.26.16.53.2.8h2l2.1-1.63a.48.48 0 00.16-.64M12 8c-2.21 0-4 1.8-4 4 0 1.91 1.35 3.54 3.21 3.92L16 11.86A3.997 3.997 0 0012 8m0 6c-1.1 0-2-.89-2-2s.9-2 2-2 2 .9 2 2-.89 2-2 2m0-6c-2.21 0-4 1.8-4 4 0 1.91 1.35 3.54 3.21 3.92L16 11.86A3.997 3.997 0 0012 8m0 6c-1.1 0-2-.89-2-2s.9-2 2-2 2 .9 2 2-.89 2-2 2z" />
            </svg>
            Mod support
        </h2>
        <p>add new towns, creatures, heroes, artifacts and spells without limits or conflicts</p>
    </div>
    <div class="feature-item">
        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path fill="currentColor"
                d="M 21.308712,0 C 17.316191,0 11.958941,2.7391436 8.3613709,7.448385 H 5.3790375 c -2.1550041,0 -3.3901326,1.6084788 -4.2405519,3.309503 L 0,13.034673 h 2.6877497 2.6912878 l 2.7931444,2.793145 2.7931441,2.793144 V 21.312249 24 l 2.276785,-1.1383 c 1.701025,-0.850605 3.309504,-2.085734 3.309504,-4.240738 V 15.63863 C 21.260857,12.041059 24,6.6838083 24,2.6912878 V 0 Z m -4.757097,5.5862888 c 1.028436,0 1.862095,0.8336605 1.862095,1.8620962 v 0 c 0,1.0284358 -0.833659,1.8620962 -1.862095,1.8620962 v 0 c -1.028436,0 -1.862096,-0.8336604 -1.862096,-1.8620962 v 0 c 0,-1.0284357 0.83366,-1.8620962 1.862096,-1.8620962 z M 4.4479892,16.758867 3.5169412,17.689915 c -1.3448059,1.344805 -1.8620963,4.655239 -1.8620963,4.655239 0,0 3.1618395,-0.368693 4.6552408,-1.862095 l 0.931048,-0.931048 z"/>
            </svg>
            Launcher
        </h2>
        <p>easy configuration - download mods from our server and install them immediatelly</p>
    </div>
    <div class="feature-item">
        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path fill="currentColor"
                    d="M16 17v2H2v-2s0-4 7-4 7 4 7 4m-3.5-9.5A3.5 3.5 0 109 11a3.5 3.5 0 003.5-3.5m3.44 5.5A5.32 5.32 0 0118 17v2h4v-2s0-3.63-6.06-4M15 4a3.39 3.39 0 00-1.93.59 5 5 0 010 5.82A3.39 3.39 0 0015 11a3.5 3.5 0 000-7z" />
            </svg>
            Multi Platform
        </h2>
        <p>Windows, Linux, macOS, iOS and Android</p>
    </div>
    <div class="feature-item">
        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 479.116 479.116" width="24" height="24">
                <path fill="currentColor"
                    d="M408.951 70.165C363.704 24.919 303.546 0 239.558 0S115.412 24.919 70.165 70.165C24.919 115.412 0 175.57 0 239.558s24.918 124.146 70.165 169.393c45.247 45.247 105.405 70.165 169.393 70.165s124.146-24.918 169.393-70.165c45.247-45.247 70.165-105.405 70.165-169.393s-24.918-124.146-70.165-169.393zm-39.366 155.893c-1.141-38.785-7.187-75.873-17.566-108.605 16.922-4.791 32.653-10.738 47.349-17.882 30.041 34.253 49.265 78.207 52.307 126.487zM226.058 450.196c-20.989-5.949-40.869-25.655-57.048-56.984a228.17 228.17 0 0 1-5.844-12.219c11.593-2.202 23.68-3.935 36.277-5.158a427.471 427.471 0 0 1 26.615-1.739zm27-76.15c21.326.656 42.336 2.977 62.887 6.956a228.196 228.196 0 0 1-5.839 12.209c-16.179 31.329-36.059 51.036-57.048 56.984zm-27-26.963c-9.7.314-19.444.927-29.225 1.877-15.111 1.467-29.588 3.622-43.422 6.429-9.922-30.536-15.727-65.521-16.87-102.331h89.517zm-89.516-121.025c1.143-36.816 6.95-71.805 16.874-102.345 23.712 4.87 47.989 7.663 72.642 8.375v93.97zm89.516-120.977c-21.327-.657-42.338-2.984-62.891-6.959a228.53 228.53 0 0 1 5.843-12.218c16.179-31.33 36.058-51.037 57.048-56.985zm27-76.161c20.989 5.948 40.869 25.655 57.048 56.985a227.875 227.875 0 0 1 5.871 12.282c-10.417 1.958-21.302 3.531-32.689 4.73a429.567 429.567 0 0 1-30.229 2.096V28.92Zm81.038 44.597c-6.618-12.816-13.906-24.061-21.732-33.669 24.658 9.017 47.19 22.48 66.629 39.411-11.359 4.975-23.438 9.21-36.287 12.755-2.686-6.4-5.554-12.579-8.61-18.497zm-189.076 0c-3.041 5.888-5.896 12.035-8.57 18.401-13.017-3.574-25.073-7.775-36.326-12.659 19.438-16.93 41.97-30.393 66.628-39.41-7.826 9.607-15.114 20.852-21.732 33.668zm-17.892 43.84c-10.398 32.755-16.455 69.878-17.597 108.701h-82.09c3.041-48.266 22.254-92.208 52.281-126.457 14.553 7.039 30.243 12.923 47.406 17.756zm-17.597 135.701c1.142 38.814 7.196 75.928 17.589 108.678-16.978 4.812-32.778 10.77-47.359 17.823-30.049-34.255-49.278-78.215-52.32-126.501Zm26.909 134.116a257.5 257.5 0 0 0 8.58 18.425c6.618 12.816 13.906 24.061 21.731 33.669-24.647-9.014-47.171-22.469-66.604-39.389 11.31-4.92 23.428-9.151 36.293-12.705zm206.215.051c12.792 3.547 24.916 7.797 36.26 12.702-19.421 16.898-41.926 30.336-66.55 39.341 7.825-9.608 15.113-20.853 21.732-33.669 3.036-5.88 5.887-12.018 8.558-18.374zM325.701 355.4c-23.709-4.874-47.99-7.655-72.643-8.367v-93.975h89.516c-1.144 36.815-6.95 71.803-16.873 102.342zm-72.643-129.342v-94.023a456.82 456.82 0 0 0 33.056-2.267c13.854-1.458 27.024-3.464 39.606-5.993 9.912 30.525 15.712 65.492 16.855 102.283zm146.193 153.618.068-.141c-14.598-7.008-30.463-12.952-47.339-17.75 10.403-32.762 16.463-69.894 17.605-108.728h82.089c-3.045 48.343-22.315 92.347-52.423 126.619z"/>
                </svg>
            Lobby
        </h2>
        <p>Global lobby to play together</p>
        <p id="lobby_stat"></p>
    </div>
</div>

<!-- screenshots -->
<div class="top-hr">
    <div class="feature-item screenshot-box">
        <a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom" href="img/screenshots/main_page/Castle%20Siege.webp"><img src="img/screenshots/main_page/Castle%20Siege.webp" class="screenshot" /></a>
    </div>
    <div class="feature-item screenshot-box">
        <a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom" href="img/screenshots/main_page/Town%20Screen%20with%20Radial%20Menu.webp"><img src="img/screenshots/main_page/Town%20Screen%20with%20Radial%20Menu.webp" class="screenshot" /></a>
    </div>
    <div class="feature-item screenshot-box">
        <a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom" href="img/screenshots/main_page/Big%20spellbook.webp"><img src="img/screenshots/main_page/Big%20spellbook.webp" class="screenshot" /></a>
    </div>
    <div class="feature-item screenshot-box">
        <a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom" href="img/screenshots/main_page/Quick%20Hero%20Select%20Bastion.webp"><img src="img/screenshots/main_page/Quick%20Hero%20Select%20Bastion.webp" class="screenshot" /></a>
    </div>
    <div class="feature-item screenshot-box">
        <a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom" href="img/screenshots/main_page/Antagarich%20Burning%20Battle.webp"><img src="img/screenshots/main_page/Antagarich%20Burning%20Battle.webp" class="screenshot" /></a>
    </div>
    <div class="feature-item screenshot-box">
        <a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom" href="img/screenshots/main_page/Town%20and%20Unit.webp"><img src="img/screenshots/main_page/Town%20and%20Unit.webp" class="screenshot" /></a>
    </div>
    <div class="feature-item screenshot-box">
        <a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom" href="img/screenshots/main_page/Siege.webp"><img src="img/screenshots/main_page/Siege.webp" class="screenshot" /></a>
    </div>
    <div class="feature-item screenshot-box">
        <a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom" href="img/screenshots/main_page/Editor.webp"><img src="img/screenshots/main_page/Editor.webp" class="screenshot" /></a>
    </div>
</div>

{% endblock %}
{% block container %}{% endblock %}
